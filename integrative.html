
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Integrative workflows &#8212; lcdb-wf 0.1 documentation</title>
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Configuration details" href="config.html" />
    <link rel="prev" title="ChIP-seq workflow" href="chipseq.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="toc.html">lcdb-wf</a></h1>



<p class="blurb">Customizable workflows for high-throughput sequencing analysis</p>






<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting-started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="guide.html">Guide to file hierarchy</a></li>
<li class="toctree-l1"><a class="reference internal" href="tests.html">Testing the installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="workflows.html">Overview of workflows</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="workflows.html#primary-analysis-workflows">Primary analysis workflows</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="workflows.html#integrative-analysis-workflows">Integrative analysis workflows</a></li>
<li class="toctree-l2"><a class="reference internal" href="workflows.html#features-common-to-workflows">Features common to workflows</a></li>
<li class="toctree-l2"><a class="reference internal" href="workflows.html#next-steps">Next Steps</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="config.html">Configuration details</a></li>
<li class="toctree-l1"><a class="reference internal" href="references.html">References workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="rnaseq.html">RNA-seq workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="downstream-rnaseq.html">RNA-Seq downstream analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="chipseq.html">ChIP-seq workflow</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Integrative workflows</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#colocalization-workflow">Colocalization workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="#external-workflow">“External” workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="#figures-workflow">“Figures” workflow</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="faqs.html">FAQs</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="developers.html">For Developers</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="toc.html">Documentation overview</a><ul>
  <li><a href="workflows.html">Overview of workflows</a><ul>
      <li>Previous: <a href="chipseq.html" title="previous chapter">ChIP-seq workflow</a></li>
      <li>Next: <a href="config.html" title="next chapter">Configuration details</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="integrative-workflows">
<span id="integrative"></span><h1>Integrative workflows<a class="headerlink" href="#integrative-workflows" title="Permalink to this headline">¶</a></h1>
<p>Here we look at integrative workflows which can be used to combine multiple
standard or non-standard workflows.</p>
<div class="section" id="colocalization-workflow">
<span id="colocalization"></span><h2>Colocalization workflow<a class="headerlink" href="#colocalization-workflow" title="Permalink to this headline">¶</a></h2>
<p>The output of this workflow is a set of heatmaps showing metrics of
colocalization between pairs of regions. This can be used to answer questions
like “what else does my protein of interest bind with?”.</p>
<p>Several colocalization methods are run, and they all give slightly different
results.</p>
<ul class="simple">
<li><p>bedtools fisher</p></li>
<li><p>bedtools jaccard</p></li>
<li><p>GAT (Genome Association Test) log2 fold change</p></li>
<li><p>GAT (Genome Association Test) nucleotide overlap</p></li>
<li><p>IntervalStats</p></li>
</ul>
</div>
<div class="section" id="external-workflow">
<span id="external"></span><h2>“External” workflow<a class="headerlink" href="#external-workflow" title="Permalink to this headline">¶</a></h2>
<p>Often we want to compare new data with existing published data. We have found
that in practice, having a separate workflow to handle downloading and
reformatting and various conversion tasks helps with organization.</p>
<p>The test workflow is a working example that:</p>
<ul class="simple">
<li><p>downloads ChIP-seq data from modENCODE in an older fly genome organism (dm3)</p></li>
<li><p>downloads the chainfile for liftover</p></li>
<li><p>fixes the formatting of the downloaded files so they can be lifted over</p></li>
<li><p>lifts over the files to the newer dm6 assembly.</p></li>
</ul>
<p>The file is intended to be heavily edited for the particular experiment; it is
here mostly as a placeholder and to be used as a template for integrative
downstream work.  It can then be incorporated into the <code class="docutils literal notranslate"><span class="pre">figures</span></code> workflow (see
<a class="reference internal" href="#figures"><span class="std std-ref">“Figures” workflow</span></a>) to integrate the analysis with other output.</p>
<img alt="_images/external.png" src="_images/external.png" />
</div>
<div class="section" id="figures-workflow">
<span id="figures"></span><h2>“Figures” workflow<a class="headerlink" href="#figures-workflow" title="Permalink to this headline">¶</a></h2>
<p>This workflow is a working example of how you would tie together output from
RNA-seq, ChIP-seq, and “external” workflows to automate figure creation and
formally link together the dependencies of each figure all the way back to the
original fastq files. If any changes are made upstream, they will trigger
downstream rules to re-run as needed.</p>
<p>For example, if a new GTF annotation file comes out, you would change the URL
in the config, and then re-run the figures workflow. All RNA-seq jobs that
depended on some way on the GTF file will be re-run. This will include the
feature counts and downstream RNA-seq analysis, but will <em>not</em> re-run any of
the jobs like trimming or mapping that do not depend on the GTF. In addition,
any figures that depended in some way on that GTF file will also be re-run.</p>
<p>To provide a sufficiently complex example that can be used in real-world
applications, this workflow currently:</p>
<blockquote>
<div><ul class="simple">
<li><p>counts the number of peaks in all configured peak-calling runs and stores
the output in a TSV report (work is performed in the script
<code class="docutils literal notranslate"><span class="pre">scripts/peak_count.py</span></code>)</p></li>
<li><p>identifies peaks at promoters of genes, reports a summary of how many
peaks from each run were found in a promoter, and creates BED files of
these subsets (<code class="docutils literal notranslate"><span class="pre">scripts/peaks_at_promoters.py</span></code>)</p></li>
<li><p>builds the DAG image for the ChIP-seq and RNA-seq workflows</p></li>
<li><p>symlinks over the ChIP-seq peaks and RNA-seq differential expression results</p></li>
<li><p>extracts the text from the README.txt files created by the scripts
(usually from their docstrings), and compiles them into a summary report</p></li>
<li><p>the <code class="docutils literal notranslate"><span class="pre">figures</span></code> directory can then be zipped up and distributed to collaborators</p></li>
</ul>
</div></blockquote>
</div>
</div>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;2017, Ryan Dale, Justin Fear.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.5.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/integrative.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>