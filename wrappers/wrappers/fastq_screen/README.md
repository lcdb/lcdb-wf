# Wrapper for fastq_screen

[`fastq_screen`](http://www.bioinformatics.babraham.ac.uk/projects/fastq_screen)
screens a library of sequences in FASTQ format against a set of sequence
databases identifying the composition of the library and possible contaminants.

Fastq screen uses a configuration file pointing to different database. For example:

```
DATABASE	ecoli	/data/Escherichia_coli/Bowtie2Index/genome	BOWTIE2
DATABASE	hg19	/data/hg19/Bowtie2Index/genome	BOWTIE2
DATABASE	mm10	/data/mm10/Bowtie2Index/genome	BOWTIE2
```

This configuration file is automatically generated by the wrapper based on
which indexes are given as inputs (see **Example**). Currently the wrapper only
supports bowtie2 and defaults to using a subset of 100000 reads.  Which can be
overridden using `params.subset` setting.  Furthermore, `params.extra` is
passed arguments verbatim to `fastq_screen`, for example
`extra="--illumina1_3"` or `extra="--bowtie2 '--trim5=8'"`.

Note that `fastq_screen` hard-codes the output filenames. This wrapper moves
the hard-coded output files to those specified by the rule. Currently the
wrapper does not save png's generated by fastq screen. It does, however, support
the contextual saving of tagged and/or filtered output fastqs from fastq_screen.
If desired, combinations of "--tag" and/or "--filter [filter_codes]" should be
provided to the run via the "extra" parameter in the Snakemake rule. The output
fastqs will *not* be tracked by Snakemake. They will be named as
"{snakemake.output.txt}.tagged.fastq.gz" or "{snakemake.output.txt}.tagged_filter.fastq.gz"
respectively.

## Example:

```
rule fastq_screen:
    input:
        fastq="samples/{sample}.fastq.gz",
        ecoli=["/data/Escherichia_coli/Bowtie2Index/genome.1.bt2", "/data/Escherichia_coli/Bowtie2Index/genome.2.bt2"],
        hg19=["/data/hg19/Bowtie2Index/genome.1.bt2", "/data/hg19/Bowtie2Index/genome.2.bt2"],
        mm10=["/data/mm10/Bowtie2Index/genome.1.bt2", "/data/mm10/Bowtie2Index/genome.2.bt2"]
    output:
        txt="qc/{sample}.fastq_screen.txt"
    params:
        subset=100000,
        aligner='bowtie2'
    threads: 8
    wrapper:
        "file:wrapper"
```

## Input

* `fastq` is a FASTQ file, gzipped or not.

* Additional arguments are used as labels and their values will be used to
  generate database location.

## Output

`txt`: a text file containing the fraction of reads mapping to each provided
index
